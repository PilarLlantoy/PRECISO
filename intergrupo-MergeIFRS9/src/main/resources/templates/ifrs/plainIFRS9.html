<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<div th:replace="fragments/menuTemplate :: menuHead"></div>

<body>
<div th:replace="fragments/menuTemplate :: menuBody"></div>
<div class="main-container">
  <!-- Cover -->
  <div class="row m-0 bg-primary fixed-top myNav">
    <form class="form-inline" method="get" th:action="@{/ifrs9/plainIFRS9}">
      <div class="col-md-4 border-bottom border-primary p-0 bg-primary d-flex justify-content-start align-items-center">
        <h3 class="fw-bold text-white mx-4 my-3">Plantillas Neocon</h3>
        <h5 class="fw-bold text-white mx-4 my-3" th:utext="'Periodo: '+${period}"></h5>
      </div>
      <div class="col-md-4 d-flex align-items-center justify-content-center">
        <div class="input-group">
          <div class="input-group-append d-flex align-items-center">
            <h5 class="me-2 mb-0">Fecha Consulta: </h5>
            <input class="form-control" required th:value="${period}"  th:name="period" type="month">
            <button class="btn btn-secondary" type="submit"><i class="fa fa-search"></i></button>
          </div>
        </div>
      </div>
      <div class="col-md-4 d-flex align-items-center justify-content-end">
        <div class="input-group d-flex align-items-center ">
          <h5 class="me-2 mb-0">Filtro: </h5>
          <input class="form-control rounded" placeholder="Buscar..." th:name="vId" th:value="${vId}" type="text">
          <div class="input-group-append d-flex align-items-center">
            <select class="form-control" th:name="vFilter" th:value="${vFilter}">
              <option disabled hidden selected value="">Seleccione un filtro</option>
              <option th:each="item : ${columns}" th:text="${item}" th:selected="${vFilter==item}" th:value="${item}"></option>
            </select>
          </div>
          <div class="input-group-append d-flex align-items-center">
            <button class="btn btn-secondary" type="submit"><i class="fa fa-search"></i></button>
          </div>
        </div>
      </div>
    </form>
  </div>
  <div id="content">
    <div class="row mt-5 justify-content-between">
      <div class="col-md-5 my-1 border p-2">
        <form method="POST" id="fileUploadForm" class="d-flex flex-column px-1" enctype="multipart/form-data" th:action="@{/ifrs9/intergroupUpload/upload?period={period}(period=${period})}">
          <h3>Información Intergrupo</h3>
          <div class="d-flex align-items-center justify-content-start my-1">
            <h5 class="fw-bold m-0 mx-1"><strong>Estado Plano Inter. Provisiones:</strong></h5>
            <i class="fa fa-check-circle text-success mx-1" th:if="${validateInterProv}"></i>
            <i class="fa fa-times-circle text-danger mx-1" th:if="${!validateInterProv}"></i>
            <label style="margin-bottom: 0;" class="mr-1" th:if="${validateInterProv}" th:text="'Última carga el '+${dateProv}"></label>
            <label style="margin-bottom: 0;" class="mr-1" th:if="${!validateInterProv}">Sin cargar</label>
          </div>
          <div class="d-flex align-items-center justify-content-start my-1">
            <h5 class="fw-bold m-0 mx-1"><strong>Estado Plano Inter. Reclasificaciones:</strong></h5>
            <i class="fa fa-check-circle text-success mx-1" th:if="${validateInterRec}"></i>
            <i class="fa fa-times-circle text-danger mx-1" th:if="${!validateInterRec}"></i>
            <label style="margin-bottom: 0;" class="mr-1" th:if="${validateInterRec}" th:text="'Última carga el '+${dateRec}"></label>
            <label style="margin-bottom: 0;" class="mr-1" th:if="${!validateInterRec}">Sin cargar</label>
          </div>
          <div class="form-group my-3">
            <label>Cargar Archivos Intergrupo:</label>
            <input accept=".txt,.csv" class="custom-file-control" id="file" name="file" type="file" multiple required>
            <button class="btn btn-primary mx-2" type="submit" id="btnUpload">Cargar</button>
          </div>
        </form>
        <div class="col-md-12">
          <button class="btn btn-primary px-1" id="clearTableInter" th:data="${period}" th:onclick="'javascript:operationDeleteReconIFRS9(\'interPlane\',this.getAttribute(\'data\'))'">Limpiar Plano Intergrupo</button>
          <a class="btn btn-primary px-1"
             th:href="@{/ifrs9/plainIFRS9/downloadpi/?period={period}(period=${period})}">Exportar Planos Cargados</a>
        </div>
      </div>
      <div class="col-md-6 my-1 p-1">
        <form th:action="@{/ifrs9/CalPlainIFRS9}" class="border p-2" id="form1" method="get">
          <h3>Información Provisiones y Reclasificaciones</h3>
          <div class="row my-2 align-items-center" th:if="${noData == false}">
            <p class="fw-bold me-2 pt-2 mb-0">No hay Conciliación IFRS9 generada para la fecha</p>
          </div>
          <div class="row my-2 border-top p-2" th:if="${noData}">
            <div class="col-4 d-flex flex-column  border-right">
              <input id="periodConfirm" type="hidden" th:value="${period}" th:name="period" class="form-control" required>
              <button type="submit" class="btn btn-primary btn-block">Generar Información Planos</button>
            </div>
            <div class="col-4 d-flex flex-column align-items-center border-right">
              <a class="btn btn-primary btn-block px-1" th:if="${pygData == false}" th:href="@{/ifrs9/plainIFRS9/generatePYG/?period={period}(period=${period})}">Generar PYG</a>
              <button class="btn btn-primary btn-block px-1" th:if="${pygData == true}" disabled>Generar PYG</button>
              <button class="btn btn-primary btn-block px-1" th:if="${pygImpu == true}" disabled>Excluir PYG</button>
              <a class="btn btn-info btn-block px-1" th:if="${pygData == false and pygImpu == false}" th:href="@{/ifrs9/CalPlainIFRS9PYG/?period={period}&pygData={pygData}(period=${period},pygData=${pygData})}">Confirmar PYG</a>
              <a class="btn btn-danger btn-block px-1" th:if="${pygData == true and pygImpu == false}" th:href="@{/ifrs9/CalPlainIFRS9PYG/?period={period}&pygData={pygData}(period=${period},pygData=${pygData})}">Excluir PYG</a>
            </div>
            <div class="col-4 d-flex flex-column align-items-center">
              <a class="btn btn-primary btn-block px-1" th:if="${pygData2 == true and pygData == true and pygImpu == false}" th:href="@{/ifrs9/plainIFRS9/generateImpuestos/?period={period}(period=${period})}">Generar Impuestos</a>
              <button class="btn btn-primary btn-block px-1" th:if="${pygData2 == false and pygData == false and pygImpu == false}" disabled>Generar Impuestos</button>
              <button class="btn btn-primary btn-block px-1" th:if="${pygData2 == false and pygData == true and pygImpu == false}" disabled>Generar Impuestos</button>
              <button class="btn btn-primary btn-block px-1" th:if="${pygData2 == true and pygData == false and pygImpu == false}" disabled>Generar Impuestos</button>
              <button class="btn btn-primary btn-block px-1" th:if="${pygData2 == true and pygData == true and pygImpu == true}"disabled>Generar Impuestos</button>
              <button class="btn btn-primary btn-block px-1" th:if="${pygData2 == false or pygData == false}" disabled="">Confirmar Impuestos</button>
              <a class="btn btn-info btn-block px-1" th:if="${pygData2 == true and pygData == true and pygImpu == false}" th:href="@{/ifrs9/CalPlainIFRS9Impuestos/?period={period}&pygImpu={pygImpu}(period=${period},pygImpu=${pygImpu})}">Confirmar Impuestos</a>
              <a class="btn btn-danger btn-block px-1" th:if="${pygData2 == true and pygData == true and pygImpu == true}" th:href="@{/ifrs9/CalPlainIFRS9Impuestos/?period={period}&pygImpu={pygImpu}(period=${period},pygImpu=${pygImpu})}">Excluir Impuestos</a>
            </div>
          </div>
          <div class="row my-1 border-top p-2">
            <div class="col-4 d-flex flex-column  border-right">
              <a class="btn btn-primary btn-block px-1" th:if="${pygData2 == false}" th:href="@{/ifrs9/plainIFRS9/generateRepos/?period={period}(period=${period})}">Generar Repos</a>
              <button class="btn btn-primary btn-block px-1" th:if="${pygData2 == true}" disabled>Generar Repos</button>
            </div>
            <div class="col-4 d-flex flex-column">
              <button class="btn btn-primary btn-block px-1" th:if="${pygImpu == true}" disabled>Excluir Repos</button>
              <a class="btn btn-info btn-block px-1" th:if="${pygData2 == false and pygImpu == false}" th:href="@{/ifrs9/CalPlainIFRS9PYG2/?period={period}&pygData2={pygData2}(period=${period},pygData2=${pygData2})}">Confirmar Repos</a>
              <a class="btn btn-danger btn-block px-1" th:if="${pygData2 == true and pygImpu == false}" th:href="@{/ifrs9/CalPlainIFRS9PYG2/?period={period}&pygData2={pygData2}(period=${period},pygData2=${pygData2})}">Excluir Repos</a>
            </div>
          </div>
          <div class="row p-1 border-top" th:if="${noData}">
            <div class="col-4 mt-1 d-flex flex-column align-items-center">
              <button type="button" class="btn btn-danger btn-block" th:data1="${period}" id="clearTable" th:onclick="'javascript:operationDeleteReconIFRS9(\'PLAIN-IFRS9\', this.getAttribute(\'data1\'))'">Limpiar Tabla</button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 mt-1">
        <div class="table-responsive rounded border-primary">
          <table id="example" class="table table-sm table-striped table-hover text-center table-bordered" width="100%">
            <thead class="bg-primary">
              <tr>
                <th>Tipo Reg.</th>
                <th>Sociedad</th>
                <th>Tipo Cons.</th>
                <th>Tipo Asiento</th>
                <th>Descripción</th>
                <th>Mov.</th>
                <th>Referencia</th>
                <th>Modo Ejecución</th>
                <th>Usuario</th>
                <th>Cód. Cons.</th>
                <th>Nat.</th>
                <th>Saldo</th>
                <th>Divisa</th>
                <th>País</th>
                <th>Edición</th>
              </tr>
            </thead>
            <tbody>
            <tr>
            <tr th:each="val : ${allValidation}">
              <td th:text="${val.tipoRegistro}"></td>
              <td th:text="${val.sociedad}"></td>
              <td th:text="${val.tipocons}"></td>
              <td th:text="${val.tipoAsiento}"></td>
              <td th:text="${val.descripcion}"></td>
              <td th:text="${val.movimiento}"></td>
              <td th:text="${val.referencia}"></td>
              <td th:text="${val.modoEjecucion}"></td>
              <td th:text="${val.usuario}"></td>
              <td th:text="${val.codicons}"></td>
              <td th:text="${val.naturalezaTotal}"></td>
              <td th:text="${#numbers.formatDecimal(val.saldo,1,'POINT',2,'COMMA')}"></td>
              <td th:text="${val.divisa}"></td>
              <td th:text="${val.paisNegocio}"></td>
              <td>
                <a class="btn btn-primary btn-sm"
                   th:href="@{/ifrs9/plainIFRS9/modify/{id}(id=${val.getId()})}">Editar</a>
              </td>
            </tr>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="row" th:if="${last != 0}">
      <div class="col-md-4 text-left">
        <nav arial-label="Pagination">
          <ul class="pagination">
            <li class="page-item" th:classappend="${prev == 0 ? 'disabled' : ''}">
              <a class="page-link" th:href="@{/ifrs9/{dir}/?page={page}(period=${period},vId=${vId},vFilter=${vFilter},page=${prev},dir=${directory})}">Anterior</a>
            </li>
            <li class="page-item" th:classappend="${current == last ? 'disabled' : ''}">
              <a class="page-link" th:href="@{/ifrs9/{dir}/?page={page}(period=${period},vId=${vId},vFilter=${vFilter},page=${next},dir=${directory})}">Siguiente</a>
            </li>
          </ul>
        </nav>
      </div>
      <div class="col-md-4 text-center">
        <h6 th:utext="${registers} + ' Registros Encontrados'"></h6>
      </div>
      <div class="col-md-4 text-right">
        <h6 class="mx-1" th:utext="'Página ' + ${current} + ' de ' + ${last}" ></h6>
      </div>
    </div>
    <div class="pr-3 col-md-12 my-2">
      <div class="d-flex align-items-center justify-content-center">
        <a th:href="@{/ifrs9/plainIFRS9/download?period={period}(period=${period})}"
           class="btn btn-primary mx-1">Exportar Tabla Completa</a>
        <a th:href="@{/ifrs9/plainIFRS9/downloadp?type=PROV&period={period}(period=${period})}"
           class="btn btn-primary mx-1">Exportar Plano Provisiones</a>
        <a th:href="@{/ifrs9/plainIFRS9/downloadResumen?type=PROV&period={period}(period=${period})}"
           class="btn btn-primary mx-1">Exportar Resumen Provisiones</a>
        <a th:href="@{/ifrs9/plainIFRS9/downloadp?type=REC&period={period}(period=${period})}"
           class="btn btn-primary mx-1">Exportar Plano Reclas.</a>
        <a th:href="@{/ifrs9/plainIFRS9/downloadResumen?type=REC&period={period}(period=${period})}"
           class="btn btn-primary mx-1">Exportar Resumen Reclas.</a>
        <a th:href="@{/ifrs9/plainIFRS9/downloadp?type=PYG&period={period}(period=${period})}"
           class="btn btn-primary mx-1">Exportar Plano Repos.</a>
        <!--<a th:href="@{/ifrs9/plainIFRS9/downloadResumen?type=PYG&period={period}(period=${period})}"
           class="btn btn-primary mx-1">Exportar Resumen Repos.</a>-->
      </div>
    </div>
  </div>
</div>
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js" ></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
<script type="text/javascript">
  var queryString = window.location.search;
  var urlParams = new URLSearchParams(queryString);
  var respuesta = urlParams.get('resp');
  var row = urlParams.get('row');
  var column = urlParams.get('colum');


  validateAlerts(respuesta,row,column);
  $(document).ready(function() {
    $('#sidebarCollapse').on('click', function() {
      $('#sidebar').toggleClass('active');
    });
  });
</script>
</body>

</html>
