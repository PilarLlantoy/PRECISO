<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">

<div th:replace="fragments/menuTemplate :: menuHead"></div>

<body>
<div th:replace="fragments/menuTemplate :: menuBody"></div>
<div class="main-container">
  <!-- Cover -->
  <div class="row m-0 bg-primary fixed-top myNav">
      <div class="col-md-4 border-bottom border-primary p-0 bg-primary d-flex justify-content-start align-items-center">
        <h3 class="fw-bold text-white mx-4 my-3">Histórico PYG & Impuesto</h3>
        <!--<h5 class="fw-bold text-white mx-4 my-3" th:utext="'Periodo: '+${period}"></h5>-->
      </div>
      <div class="col-md-4 d-flex align-items-center justify-content-center">
      </div>
      <div class="col-md-4 d-flex align-items-center justify-content-end">
      </div>
  </div>
  <div id="content">
    <div class="row mt-5 justify-content-end">
      <div class="col-md-12 my-1">
        <form class="form-inline" method="get" th:action="@{/ifrs9/historicPyg/downloadCargaMasiva}">
          <a href="#exportModal" role="button" class="btn btn-large btn-primary mx-1" data-toggle="modal" >Parametros Carga Masiva</a>
            <h5 class="ml-3 mb-0">Periodo: </h5>
            <input class="form-control" required th:value="${period}"  th:name="period" type="month">
            <input class="form-check-input ml-1" type="checkbox" id="rever" th:name="rever">
            <label class="form-check-label" for="rever">Aplica Reversión</label>
          <button class="btn btn-primary mx-1" type="submit">Descargar Carga Masiva</button>
          <a class="btn btn-primary mx-1" th:href="@{/ifrs9/historicPyg?period={period}(period=${period})}"><i class="fas fa-redo-alt"></i></a>
        </form>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12 mt-1">
        <div class="table-responsive rounded border-primary">
          <table id="example" class="table table-sm table-striped table-hover text-center table-bordered" width="100%">
            <thead class="bg-primary">
              <tr>
                <th>Tipo Reg.</th>
                <th>Sociedad</th>
                <th>Tipo Cons.</th>
                <th>Tipo Asiento</th>
                <th>Descripción</th>
                <th>Mov.</th>
                <th>Referencia</th>
                <th>Modo Ejecución</th>
                <th>Usuario</th>
                <th>Cód. Cons.</th>
                <th>Nat.</th>
                <th>Saldo</th>
                <th>Divisa</th>
                <th>País</th>
              </tr>
            </thead>
            <tbody>
            <tr>
            <tr th:each="val : ${allValidation}">
              <td th:text="${val.tipoRegistro}"></td>
              <td th:text="${val.sociedad}"></td>
              <td th:text="${val.tipocons}"></td>
              <td th:text="${val.tipoAsiento}"></td>
              <td th:text="${val.descripcion}"></td>
              <td th:text="${val.movimiento}"></td>
              <td th:text="${val.referencia}"></td>
              <td th:text="${val.modoEjecucion}"></td>
              <td th:text="${val.usuario}"></td>
              <td th:text="${val.codicons}"></td>
              <td th:text="${val.naturalezaTotal}"></td>
              <td th:text="${#numbers.formatDecimal(val.saldo,1,'POINT',2,'COMMA')}"></td>
              <td th:text="${val.divisa}"></td>
              <td th:text="${val.paisNegocio}"></td>
            </tr>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="row" th:if="${last != 0}">
      <div class="col-md-4 text-left">
        <nav arial-label="Pagination">
          <ul class="pagination">
            <li class="page-item" th:classappend="${prev == 0 ? 'disabled' : ''}">
              <a class="page-link" th:href="@{/ifrs9/{dir}/?page={page}(period=${period},vId=${vId},vFilter=${vFilter},page=${prev},dir=${directory})}">Anterior</a>
            </li>
            <li class="page-item" th:classappend="${current == last ? 'disabled' : ''}">
              <a class="page-link" th:href="@{/ifrs9/{dir}/?page={page}(period=${period},vId=${vId},vFilter=${vFilter},page=${next},dir=${directory})}">Siguiente</a>
            </li>
          </ul>
        </nav>
      </div>
      <div class="col-md-4 text-center">
        <h6 th:utext="${registers} + ' Registros Encontrados'"></h6>
      </div>
      <div class="col-md-4 text-right">
        <h6 class="mx-1" th:utext="'Página ' + ${current} + ' de ' + ${last}" ></h6>
      </div>
    </div>
    <div class="pr-3 col-md-12 my-2">
      <div class="d-flex align-items-center justify-content-center">
        <a th:href="@{/ifrs9/historicPyg/downloadAll?period={period}(period=${period})}"
           class="btn btn-primary mx-1">Exportar Histórico</a>
      </div>
    </div>
    <div class="modal fade" id="exportModal">
      <div class="modal-dialog rounded-1 modal-dialog-centered modal-lg">
        <div class="modal-content">
          <form method="get" th:action="@{/ifrs9/historicPyg/updateParameters}" th:object="${object1}">
            <div class="modal-header bg-primary text-light">
              <h4 class="modal-title">Parametros Carga Masiva</h4>
              <button aria-hidden="true" class="close" data-dismiss="modal" type="button">
                <i class="fas fa-times"></i>
              </button>
            </div>
            <div class="modal-body">
              <div class="row text-center">
                <h5 class="fw-bold">Ingrese los siguientes datos:</h5>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <div class="form-text">
                    <label for="centro" class="col-form-label">Centro:</label>
                    <input type="hidden" class="form-control" id="period" th:name="period" th:value="${period}">
                    <input type="text" class="form-control" id="centro" th:name="centro" th:value="*{centro}" required>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="form-text">
                    <label for="tpD" class="col-form-label">TP:</label>
                    <input type="text" class="form-control" id="tpD" th:name="tpD" th:value="*{tp}" required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-text">
                    <label for="tercero" class="col-form-label">Tercero:</label>
                    <input type="text" class="form-control" id="tercero" th:name="tercero" th:value="*{tercero}" required>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="form-text">
                    <label for="dvD" class="col-form-label">DV:</label>
                    <input type="text" class="form-control" id="dvD" th:name="dvD" th:value="*{dv}" required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-text">
                    <label for="codiconsH" class="col-form-label">Cuenta España Pasivo:</label>
                    <input type="text" class="form-control" id="codiconsH" th:name="codiconsH" th:value="*{cuentaEspanaPyg}" required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-text">
                    <label for="cuentaH" class="col-form-label">Cuenta Local Pasivo:</label>
                    <input type="text" class="form-control" id="cuentaH" th:name="cuentaH" th:value="*{cuentaLocalPyg}"  required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-text">
                    <label for="codiconsD" class="col-form-label">Cuenta España PYG:</label>
                    <input type="text" class="form-control" id="codiconsD" th:name="codiconsD" th:value="*{cuentaEspanaPasivo}" required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-text">
                    <label for="cuentaD" class="col-form-label">Cuenta Local PYG:</label>
                    <input type="text" class="form-control" id="cuentaD" th:name="cuentaD" th:value="*{cuentaLocalPasivo}" required>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer d-flex justify-content-center">
              <button class="btn btn-primary" type="submit">Actualizar Parametros</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js" ></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
<script type="text/javascript">
  var queryString = window.location.search;
  var urlParams = new URLSearchParams(queryString);
  var respuesta = urlParams.get('resp');
  var row = urlParams.get('row');
  var column = urlParams.get('colum');


  validateAlerts(respuesta,row,column);
  $(document).ready(function() {
    $('#sidebarCollapse').on('click', function() {
      $('#sidebar').toggleClass('active');
    });
  });
</script>
</body>

</html>
